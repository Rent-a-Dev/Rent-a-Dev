<head>
    <style>

        #requestTableContainer{
            margin-top: 2em;
            display: flex;
            justify-content: center;
        }

        table{
            border-collapse: collapse;
            width: 90%;
            border: 1px solid black;
        }

        th, td{
            border-bottom: 1px solid black;
            font-size: 20px;
            font-family: Arial, Helvetica, sans-serif;
            padding: 1em;
        }

        td{
            text-align: center;
        }

        #headings{
            background-color: #679186;
        }

        button{
            font-size: 16px;
            padding: 0.5em 2em;
            border-radius: 5em;
        }

        .approveBtn{
            background-color: #679186;
            margin-right:1em;
        }

        .rejectBtn{
            background-color: #F9B4AB;
        }

        .availabilityBtn{
            border: none;
            background-color: white;
            font-size: x-large;
            font-weight: bolder;
        }

        .availability{
            background-color: lightgrey;
        }

        .hiddenRow{
            display: none;
        }

        .visibleRow{
            display: table-row;
        }

        .hiddenColumn{
            display: none;
        }

        .visibleColumn{
            display: table-cell;
        }
            
    </style>
</head>


<article id="requestTableContainer">
    <table>
        <tr id="headings">
            <th>Name</th>
            <th id="teamLead"></th>
            <th>Requested availability</th>
            <th class="availabilityColumn">Approve/Reject</th>
            <th>Request status</th>
        </tr>

        <% data.forEach((row) => {%>
        <tr>
           <td><%= row.name%></td>
            <td><%= row.teamLead%></td>
            <td><button class="availabilityBtn" onclick="showHideAvailability(<%=row.id%>)">v</button></td>
            <td class="availabilityColumn">
                <button class="approveBtn" onclick="approveRequest(<%=row.id%>)">Approve</button> 
                <button class="rejectBtn" onclick="rejectRequest(<%=row.id%>)">Reject</button></td>
            <td><%= row.requestStatus%></td>
        </tr>
        <tr class="availability hiddenRow" id=<%=row.id%>>
            <th>Hours:</th>
            <td><%= row.hours%></td>
            <th>Date Range:</th>
            <td class="availabilityColumn"></td>
            <td><%= row.startDate%> - <%= row.endDate%></td>
        </tr>
        <% }) %>
    </table>
</article>


<script>
    function showHideAvailability(id){
        let row = document.getElementById(id);
        if (row.classList.contains('hiddenRow')){
            row.classList.remove('hiddenRow');
            row.classList.add('visibleRow');
        }
        else{
            row.classList.remove('visibleRow');
            row.classList.add('hiddenRow');
        }
    }

    function configurePage(){
        let isApproveRequestsPage  = <%=isApproveRequests%>;
        let columns = document.getElementsByClassName('availabilityColumn');
        let columnName = document.getElementById("teamLead");

        if (isApproveRequestsPage){
            columnName.innerHTML = 'Requested by';
            for (column of columns){
                column.classList.add('visibleColumn');  
        }
        }
        else{
            columnName.innerHTML = 'Team Lead';
            for (column of columns){
                column.classList.add('hiddenColumn');  
            }
        }
    }

    function approveRequest(id){
        console.log("approved request with id " + id);
    }

    function rejectRequest(id){
        console.log("rejected request with id " + id);
    }

    configurePage();

</script>